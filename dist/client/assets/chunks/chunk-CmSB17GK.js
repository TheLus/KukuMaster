import{s as fe,a as me,r as t,u as pe,e as ge,j as m,c as te,g as he,b as se,d as Se,f as Ce,h as F,k as we,m as Te,C as xe,l as be,n as ye,B as Me,G as H,T as oe,p as Ae}from"./chunk-DSNX1sBz.js";function ve(e={}){const{themeId:s,defaultTheme:o,defaultClassName:n="MuiBox-root",generateClassName:r}=e,a=fe("div",{shouldForwardProp:u=>u!=="theme"&&u!=="sx"&&u!=="as"})(me);return t.forwardRef(function(g,c){const f=pe(o),{className:l,component:S="div",...d}=ge(g);return m.jsx(a,{as:S,ref:c,className:te(l,r?r(n):n),theme:s&&f[s]||f,...d})})}function ke(e){return he("MuiSvgIcon",e)}se("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Ie=e=>{const{color:s,fontSize:o,classes:n}=e,r={root:["root",s!=="inherit"&&`color${F(s)}`,`fontSize${F(o)}`]};return we(r,ke,n)},Re=Ce("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:o}=e;return[s.root,o.color!=="inherit"&&s[`color${F(o.color)}`],s[`fontSize${F(o.fontSize)}`]]}})(Te(({theme:e})=>{var s,o,n,r,a,p,u,g,c,f,l,S,d,w;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(r=(s=e.transitions)==null?void 0:s.create)==null?void 0:r.call(s,"fill",{duration:(n=(o=(e.vars??e).transitions)==null?void 0:o.duration)==null?void 0:n.shorter}),variants:[{props:i=>!i.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((p=(a=e.typography)==null?void 0:a.pxToRem)==null?void 0:p.call(a,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((g=(u=e.typography)==null?void 0:u.pxToRem)==null?void 0:g.call(u,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((f=(c=e.typography)==null?void 0:c.pxToRem)==null?void 0:f.call(c,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,i])=>i&&i.main).map(([i])=>{var C,x;return{props:{color:i},style:{color:(x=(C=(e.vars??e).palette)==null?void 0:C[i])==null?void 0:x.main}}}),{props:{color:"action"},style:{color:(S=(l=(e.vars??e).palette)==null?void 0:l.action)==null?void 0:S.active}},{props:{color:"disabled"},style:{color:(w=(d=(e.vars??e).palette)==null?void 0:d.action)==null?void 0:w.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),K=t.forwardRef(function(s,o){const n=Se({props:s,name:"MuiSvgIcon"}),{children:r,className:a,color:p="inherit",component:u="svg",fontSize:g="medium",htmlColor:c,inheritViewBox:f=!1,titleAccess:l,viewBox:S="0 0 24 24",...d}=n,w=t.isValidElement(r)&&r.type==="svg",i={...n,color:p,component:u,fontSize:g,instanceFontSize:s.fontSize,inheritViewBox:f,viewBox:S,hasSvgAsChild:w},C={};f||(C.viewBox=S);const x=Ie(i);return m.jsxs(Re,{as:u,className:te(x.root,a),focusable:"false",color:c,"aria-hidden":l?void 0:!0,role:l?"img":void 0,ref:o,...C,...d,...w&&r.props,ownerState:i,children:[w?r.props.children:r,l?m.jsx("title",{children:l}):null]})});K.muiName="SvgIcon";function ne(e,s){function o(n,r){return m.jsx(K,{"data-testid":void 0,ref:r,...n,children:e})}return o.muiName=K.muiName,t.memo(t.forwardRef(o))}const Ne=se("MuiBox",["root"]),ze=ye(),Pe=ve({themeId:be,defaultTheme:ze,defaultClassName:Ne.root,generateClassName:xe.generate}),Ue=({answer:e,onClick:s,isCorrect:o})=>{const n=t.useCallback(()=>{s==null||s(e)},[e]);return m.jsx(Me,{onClick:n,sx:{width:100,height:100,fontSize:46,backgroundColor:o?"#dfd":"#fff"},variant:"outlined",children:e})};let j=[],re=0;const je=(e,s)=>{j=[...j,{formula:e,isCorrect:s}],re=j.filter(({isCorrect:o})=>o).length/j.length},Be=()=>{j=[]},ae=()=>({answeredList:j,correctRatio:re,addAnsweredList:je,resetAnsweredList:Be}),$e=ne(m.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Ee=ne(m.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),Le=({size:e})=>m.jsx($e,{style:{color:"#f00",marginLeft:"auto",width:e,height:e}}),Oe=({size:e})=>m.jsx(Ee,{style:{color:"#0f0",marginLeft:"auto",width:e,height:e}}),Ge=({wrap:e})=>{const{answeredList:s}=ae();return m.jsx(H,{container:!0,direction:"column",alignItems:"space-between",height:"100%",width:"fit-content",columnGap:3,children:s.map(({formula:o,isCorrect:n},r)=>m.jsxs(H,{container:!0,alignItems:"center",gap:e?1:2,children:[m.jsx(oe,{fontSize:e?12:18,children:o},r),n?m.jsx(Oe,{size:e?18:24}):m.jsx(Le,{size:e?18:24})]}))})},Ke=({count:e,sx:s})=>m.jsx(oe,{sx:s,variant:"h1",children:e});let B=!1;const Qe=()=>{const[e,s]=t.useState(B),o=t.useCallback(()=>{B=!B,s(B)},[]),n=t.useCallback(()=>B,[]);return{isSupportMode:e,getIsSupportMode:n,toggleSupportMode:o}},L=(e,s=1)=>{const o=t.useRef(null),n=t.useRef(null),r=t.useRef(null),a=t.useRef(null),p=t.useRef(()=>{if(o.current==null)return;r.current=o.current.createBufferSource(),r.current.buffer=n.current;const c=o.current.createGain();c.gain.value=s,r.current.connect(c),c.connect(o.current.destination)});t.useEffect(()=>{(async()=>{o.current=new AudioContext;const l=await(await fetch(`/KukuMaster/dist/client/${e}`)).arrayBuffer();n.current=await o.current.decodeAudioData(l),p.current()})()},[e,s]);const u=t.useCallback(()=>{var c;(c=r.current)==null||c.start(0),a.current=r.current,p.current()},[]),g=t.useCallback(()=>{var c;(c=a.current)==null||c.stop(0)},[]);return{play:u,stop:g}},De=(...e)=>{const{current:s}=t.useRef(e),o=Ae(),n=t.useMemo(()=>new URLSearchParams(o.urlParsed.search),[o.urlParsed.search]),r=t.useMemo(()=>s.reduce((p,u)=>({...p,[`${u}Query`]:n.get(u)}),{}),[n,s]),a=t.useMemo(()=>Object.fromEntries(n.entries()),[n]);return{...r,all:a}},V=e=>{const s=Object.values(e).reduce((r,a)=>r+a,0),o=Math.random()*s;let n=0;for(const[r,a]of Object.entries(e))if(n+=a,o<n)return Number(r);return Number(Object.keys(e)[0])};let $=0,J=0,_=0,X=Date.now(),Y="";const U={0:0,1:0,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1},We=()=>{const e=t.useRef(-1),[s,o]=t.useState(0),[n,r]=t.useState(0),[a,p]=t.useState([1,0,0]),{play:u}=L("/correct.mp3"),{play:g}=L("/incorrect.mp3",.3),{addAnsweredList:c,resetAnsweredList:f}=ae(),{correctModeQuery:l}=De("correctMode"),S=t.useMemo(()=>s*n,[s,n]),[d,w]=t.useState(!1),[i,C]=t.useState(!1),[x,b]=t.useState(!1),{getIsSupportMode:y}=Qe(),[A,O]=t.useState(!1),R=t.useRef(!1),v=t.useRef(null),N=t.useRef(()=>{}),z=t.useMemo(()=>(d||i)&&x||l==="1",[d,i,x,l]),k=t.useMemo(()=>i?1500:3e3,[i]),M=t.useCallback(({isLastCorrect:h=!1}={isLastCorrect:!1})=>{$++;const T=!((d||i)&&(!h||R.current)),I=T?e.current===-1?V(U):e.current:s,Q=T?V(e.current===-1?U:{...U,[n]:0}):n,D=[0,0,0],P=Math.floor(Math.random()*3);D[0]=I*Q+I*(0-P),D[1]=I*Q+I*(1-P),D[2]=I*Q+I*(2-P),o(I),r(Q),p(D),O(!1),b(!1)},[s,n,d,i]),q=t.useCallback(()=>{if(!d&&!i||v.current==null)return;if(_>=0){_=k-(Date.now()-X),v.current.style.width=`${(1-_/k)*100}dvw`,requestAnimationFrame(N.current);return}const h=`${s} x ${n} = ${S}`;Y===h&&J===$||(J=$,Y=h,g(),c(h,!1),b(!0))},[d,i,k,s,n,S,$]);N.current=q;const W=t.useCallback(()=>{_=i?1500:3e3,X=Date.now(),q()},[i,q]),ce=t.useCallback(h=>{const T=h===s*n;if(T)u();else{if(y()){O(!0);return}g()}z||c(`${s} x ${n} = ${h}`,T),M({isLastCorrect:T}),W()},[c,u,g,M,W,s,n,z,y]),ie=t.useCallback(({table:h}={table:-1})=>{e.current=h,f(),M()},[f]);t.useEffect(()=>{M()},[]);const ue=t.useCallback(()=>{w(h=>{const T=!h;return T?(b(!0),C(!1)):b(!1),T})},[]),le=t.useCallback(()=>{C(h=>{const T=!h;return T?(b(!0),w(!1)):b(!1),T})},[]),de=t.useCallback(()=>{w(!1),C(!1),b(!1)},[]);return t.useEffect(()=>{R.current=x},[x]),{a1:a[0],a2:a[1],a3:a[2],q1:s,q2:n,ans:S,answer:ce,reset:ie,questionNo:$,toggleTrainingMode:ue,isTrainingMode:d,toggleOniTrainingMode:le,isOniTrainingMode:i,isShowCorrect:z,progressRef:v,finishTrainingMode:de,isAlreadyFailedOnce:A}},_e=()=>{const[e,s]=t.useState(-1),o=t.useRef(void 0),n=t.useCallback(a=>{clearTimeout(o.current),s(a)},[]),r=t.useCallback(()=>{clearTimeout(o.current),s(-1)},[]);return t.useEffect(()=>{e<=-1||(o.current=setTimeout(()=>{s(e-1)},1e3))},[e]),{count:e,beginCountdown:n,clearCountdown:r}},Fe=3e4;let G,Z,E=0,ee=Date.now();const He=({questionNo:e,reset:s,time:o=Fe,onFinish:n})=>{const[r,a]=t.useState(!1),{play:p,stop:u}=L("/countdown.mp3",.2),{play:g}=L("/dodon.mp3",.9),{play:c}=L("/don.mp3"),[f,l]=t.useState(!1),[S,d]=t.useState(0),{beginCountdown:w,clearCountdown:i,count:C}=_e(),[x,b]=t.useState(0),y=t.useRef(!1),A=t.useRef(null),O=t.useCallback(()=>{a(M=>!M)},[]),R=t.useCallback(()=>{c(),d(M=>(M>=2&&clearTimeout(Z),M+1))},[]),v=t.useCallback(()=>{if(g(),l(!0),y.current=!1,n){n();return}Z=setInterval(R,500)},[R,n]),N=t.useCallback(()=>{if(y.current){if(E<0||A.current==null){v();return}E=o-(Date.now()-ee),A.current.style.width=`${(1-E/o)*100}dvw`,requestAnimationFrame(N)}},[R,o,v]),z=t.useCallback(()=>{E=o,ee=Date.now(),requestAnimationFrame(N),y.current=!0,b(e)},[e,N,o]),k=t.useCallback(()=>{A.current!=null&&(y.current=!1,l(!1),d(0),E=0,A.current.style.width="0dvw",clearTimeout(G),G=setTimeout(()=>{s(),p(),w(3)},1e3))},[]);return t.useEffect(()=>{r?k():(y.current=!1,clearTimeout(G),u(),i())},[r,k]),t.useEffect(()=>{C===0&&r&&z()},[C,r,z]),{isTimeAttackMode:r,isTimeAttackFinished:f,resultCount:S,count:C,questionNoOffset:x,isTimeAttacking:y,toggleTimeAttackMode:O,resetTimeAttack:k,progressRef:A,setIsTimeAttackMode:a,finishTimeAttack:v}};export{Ge as A,Pe as B,Ke as C,He as a,ae as b,ne as c,We as d,Ue as e,Ee as f,Qe as u};
